import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as i,c as n,e as t}from"./app-CRdktG83.js";const a={},s=t(`<h2 id="initialization-order-for-a-single-instance" tabindex="-1"><a class="header-anchor" href="#initialization-order-for-a-single-instance"><span>Initialization Order for a Single Instance</span></a></h2><p>Consider a part of CSharp code as follows, and try to guess what is the value of <code>instance.Number</code>:</p><div class="language-c# line-numbers-mode" data-ext="c#" data-title="c#"><pre class="language-c#"><code>
var instance = new SampleClass()
{
    Number = 3;
};

Console.WriteLine(instance.Number); // What&#39;s the value of property &#39;Number&#39;?

class SampleClass
{
    public int Number {get; set;} = 1;

    public SampleClass()
    {
        Number = 2; 
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The answer is 3. In this code snippet, three different styles of initialization are performed:</p><ol><li>Initializer expression: <code>public int Number {get; set;} = 1;</code>;</li><li>Initialization in the constructor: <code>public SampleClass(){ Number = 2; }</code>;</li><li>Object initializer: <code>var instance = new SampleClass(){Number = 3;};</code>;</li></ol><p>The final value of <code>Number</code> is 3, because these initializaitions are performed in the order of initializer expression, constructor, and then object initializer. <code>Number</code> is firstly set to 1 in the initialization expression, then the constructor is invoked, where <code>Number</code> is set to 2, finally the object initializer set <code>Number</code> to 3.</p><p>If there are multiple initializations within the same category, then the actual execution order is the order in which initializers appear. For example:</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SampleClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Number <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
    Text <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Firstly <code>Number</code> will be set to 3, then <code>Text</code> will be set to &quot;Hello&quot;. And in following code:</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SampleClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Text <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span>
    Number <span class="token operator">=</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Firstly, <code>Text</code> will be set to &quot;Hello&quot;, then <code>Number</code> will be set to 3.</p><p>Likewise, the execution order of initializer expressions is the order in which these members are defined.</p><h2 id="full-initialization-order-for-static-members-and-parent-class" tabindex="-1"><a class="header-anchor" href="#full-initialization-order-for-static-members-and-parent-class"><span>Full Initialization Order, for Static Members and Parent Class</span></a></h2><p>When take static members and parent class into account, the sequence is a lot more complicated:</p><ol><li>Initializer expressions of static members of child class;</li><li>Static constructor of child class;</li><li>Initializer expressions of instance members of child class;</li><li>Initializer expressions of static members of parent class;</li><li>Static constructor of parent class;</li><li>Initializer expressions of instance members of parent class;</li><li>Instance constructor of child class;</li><li>Instance constructor of parent class;</li><li>Object initializer.</li></ol><p>This sequence can be simplified as:</p><ol><li>Static - Child <ul><li>1.1 Static - Child - Initializer - Expression;</li><li>1.2 Static - Child - Constructor;</li><li>1.3 Instance - Child - Initializer Expression;</li></ul></li><li>Static - Parent <ul><li>2.1 Static - Parent - Initializer Expression;</li><li>2.2 Static - Parent - Constructor;</li><li>2.3 Instance - Parent - Initializer Expression;</li></ul></li><li>Instance - Constructor <ul><li>3.1 Instance - Parent - Constructor;</li><li>3.2 Instance - Child - Constructor;</li></ul></li><li>Object Initializer;</li></ol><p>It is actually not so hard to understand. The general concepts are:</p><ul><li>Static ones are executed before non-static ones;</li><li>Initializer expressions are executed before constructors;</li></ul><p>The only exception is the initializer expression of instance members. This is because somehow the compiler treat initializer expressions as &quot;static contexts&quot;, and no access to instance members are allowed in initializer expressions, so they are executed in the static stage.</p><p>The parent constructor is invoked before the child constructor, because from the perspective of semantics, the child object is construcuted upon the parent object, so at the time when the child object is invoked, its members which belongs to the parent class should be ready to use.</p><p>But the static constructor of the parent class is invoked after the static constructor of the child class, because the initialization of static members take place when any member of a type is going to be accessed. The runtime firstly access the child class, so its static members are initialized, and then the runtime find its parent class, so static members of its parent class are initialized.</p><p>Object initializer will be compiled as normal member assignments and function calls to property setters, so it will be executed last.</p>`,23),o=[s];function r(l,c){return i(),n("div",null,o)}const u=e(a,[["render",r],["__file","CSharp Initialization Order of Members.html.vue"]]),m=JSON.parse(`{"path":"/posts/CSharp%20Initialization%20Order%20of%20Members.html","title":"CSharp Initialization Sequence of Members","lang":"en-US","frontmatter":{"title":"CSharp Initialization Sequence of Members","date":"2024-08-23T00:00:00.000Z","isOriginal":true,"tag":["CSharp","Fundamentals"],"description":"Initialization Order for a Single Instance Consider a part of CSharp code as follows, and try to guess what is the value of instance.Number: The answer is 3. In this code snippe...","head":[["meta",{"property":"og:url","content":"https://oldvincent.github.io/posts/CSharp%20Initialization%20Order%20of%20Members.html"}],["meta",{"property":"og:site_name","content":"Code Enthusiast"}],["meta",{"property":"og:title","content":"CSharp Initialization Sequence of Members"}],["meta",{"property":"og:description","content":"Initialization Order for a Single Instance Consider a part of CSharp code as follows, and try to guess what is the value of instance.Number: The answer is 3. In this code snippe..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-10-22T06:17:16.000Z"}],["meta",{"property":"article:author","content":"Haoyu Jia"}],["meta",{"property":"article:tag","content":"CSharp"}],["meta",{"property":"article:tag","content":"Fundamentals"}],["meta",{"property":"article:published_time","content":"2024-08-23T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-10-22T06:17:16.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CSharp Initialization Sequence of Members\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-08-23T00:00:00.000Z\\",\\"dateModified\\":\\"2024-10-22T06:17:16.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Haoyu Jia\\",\\"url\\":\\"https://github.com/OldVincent\\"}]}"]]},"headers":[{"level":2,"title":"Initialization Order for a Single Instance","slug":"initialization-order-for-a-single-instance","link":"#initialization-order-for-a-single-instance","children":[]},{"level":2,"title":"Full Initialization Order, for Static Members and Parent Class","slug":"full-initialization-order-for-static-members-and-parent-class","link":"#full-initialization-order-for-static-members-and-parent-class","children":[]}],"git":{"createdTime":1729577836000,"updatedTime":1729577836000,"contributors":[{"name":"Haoyu Jia","email":"jia_vincent@outlook.com","commits":1}]},"readingTime":{"minutes":1.99,"words":596},"filePathRelative":"posts/CSharp Initialization Order of Members.md","localizedDate":"August 23, 2024","excerpt":"<h2>Initialization Order for a Single Instance</h2>\\n<p>Consider a part of CSharp code as follows, and try to guess what is the value of <code>instance.Number</code>:</p>\\n<div class=\\"language-c#\\" data-ext=\\"c#\\" data-title=\\"c#\\"><pre class=\\"language-c#\\"><code>\\nvar instance = new SampleClass()\\n{\\n    Number = 3;\\n};\\n\\nConsole.WriteLine(instance.Number); // What's the value of property 'Number'?\\n\\nclass SampleClass\\n{\\n    public int Number {get; set;} = 1;\\n\\n    public SampleClass()\\n    {\\n        Number = 2; \\n    }\\n}\\n</code></pre></div>","autoDesc":true}`);export{u as comp,m as data};
