import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,a,o as n}from"./app-BV5fOFYU.js";const t={};function r(l,e){return n(),s("div",null,e[0]||(e[0]=[a('<h1 id="useful-commands-for-maintaining-docker-servers" tabindex="-1"><a class="header-anchor" href="#useful-commands-for-maintaining-docker-servers"><span>Useful Commands for Maintaining Docker Servers</span></a></h1><p>Usually there will be containers and images which are no longer in use, yet their creators just forgot to remove them, left them to remain in servers as &#39;Status: Exited, Last Used: 3 Years Ago&#39;. Unused containers will hold up their images, and every image of those no longer used old versions will hold up 3~5GB disk space.</p><p>Do server maintainers need to manually remove these unattended containers and images? Do server maintainers need to write some automatic scripts for this boring operation? The answer is: probably no. Docker has already provided useful commands to cleanup these cyber waste and release unused resource.</p><h2 id="what-to-clean-up" tabindex="-1"><a class="header-anchor" href="#what-to-clean-up"><span>What to Clean Up</span></a></h2><p>Usually, containers that has exited naturally (not because of faults) and resource which is not used by any container should be considered as cyber waster.</p><p>Containers, images, custom networks and attached volumes for these unused containers should be cleaned up.</p><h2 id="how-to-clean-up" tabindex="-1"><a class="header-anchor" href="#how-to-clean-up"><span>How to Clean Up</span></a></h2><h3 id="all-in-one-command" tabindex="-1"><a class="header-anchor" href="#all-in-one-command"><span>All-In-One Command</span></a></h3><p>This command will remove all exited containers, images, networks, and volumes which are not being used by any running container.</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prune</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --volume</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Option &#39;-a&#39; for remove all unused images rather than only dangling images (images without tags); option &#39;--volume&#39; for clean up unused volumes.</p><p>There will be a confirmation which requires a human operator to type &#39;y&#39; to continue, and adding &#39;-f&#39; option will skip this confirmation process:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prune</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --volume</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="individual-commands" tabindex="-1"><a class="header-anchor" href="#individual-commands"><span>Individual Commands</span></a></h3><p>Search and remove containers that exited naturally (with exit code 0):</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> `</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">-a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Exited (0)&#39; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> awk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;{print $1}&#39;`</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Remove all exited containers:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> container</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prune</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Remove all unused images:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> image</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prune</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Option &#39;-a&#39; is for removing unused images, otherwise only images without tags will be removed.</p><p>Remove all unused networks:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> network</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prune</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Remove all unused vloumes:</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prune</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="best-practice" tabindex="-1"><a class="header-anchor" href="#best-practice"><span>Best Practice</span></a></h2><ol><li><p>Use <code>Crontab</code> (a tool in Linux to schedule scripts) to schedule a clean up operation every day, or week, or month, or year.</p></li><li><p>Force every user to release resource after they finish using containers.</p></li></ol>',27)]))}const d=i(t,[["render",r]]),p=JSON.parse(`{"path":"/notes/Commands%20for%20Maintaing%20Docker%20Servers.html","title":"Useful Commands for Maintaining Docker Servers","lang":"en-US","frontmatter":{"title":"Useful Commands for Maintaining Docker Servers","icon":"emojione:recycling-symbol","date":"2024-07-23T00:00:00.000Z","isOriginal":true,"tag":["Docker","Server Maintaince"],"description":"Useful Commands for Maintaining Docker Servers Usually there will be containers and images which are no longer in use, yet their creators just forgot to remove them, left them t...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Useful Commands for Maintaining Docker Servers\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-07-23T00:00:00.000Z\\",\\"dateModified\\":\\"2025-08-07T12:17:04.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Haoyu Jia\\",\\"url\\":\\"https://github.com/OldVincent\\"}]}"],["meta",{"property":"og:url","content":"https://oldvincent.github.io/notes/Commands%20for%20Maintaing%20Docker%20Servers.html"}],["meta",{"property":"og:site_name","content":"Code Enthusiast"}],["meta",{"property":"og:title","content":"Useful Commands for Maintaining Docker Servers"}],["meta",{"property":"og:description","content":"Useful Commands for Maintaining Docker Servers Usually there will be containers and images which are no longer in use, yet their creators just forgot to remove them, left them t..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-08-07T12:17:04.000Z"}],["meta",{"property":"article:tag","content":"Server Maintaince"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:published_time","content":"2024-07-23T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-08-07T12:17:04.000Z"}]]},"git":{"createdTime":1721743390000,"updatedTime":1754569024000,"contributors":[{"name":"Haoyu Jia","username":"","email":"jia_vincent@outlook.com","commits":4}]},"readingTime":{"minutes":1.25,"words":374},"filePathRelative":"notes/Commands for Maintaing Docker Servers.md","excerpt":"\\n<p>Usually there will be containers and images which are no longer in use, yet their creators just forgot to remove them, left them to remain in servers as 'Status: Exited, Last Used: 3 Years Ago'. Unused containers will hold up their images, and every image of those no longer used old versions will hold up 3~5GB disk space.</p>","autoDesc":true}`);export{d as comp,p as data};
